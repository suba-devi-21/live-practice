"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["notifications-subscriptions-menu"],{31481:(e,t,s)=>{s.d(t,{I:()=>a});let a=(0,s(96540).createContext)(null)},67726:(e,t,s)=>{s.d(t,{l:()=>a});let a=()=>void 0},60882:(e,t,s)=>{let a;var n,i,l=s(72245),r=s(74848),o=s(96540),c=s(89323),d=s(61797),u=s(38621),h=s(28784);let m=(a="/notifications/subscribe",async e=>{try{let t=await (0,h.DI)(a,{method:"POST",body:e});if(t.ok)return t;return Error("Failed to update")}catch(e){return e}});var p=s(16823),b=s(52464);!function(e){e.NONE="none",e.WATCHING="watching",e.IGNORING="ignoring",e.CUSTOM="custom"}(n||(n={}));let y={none:"Participating and @mentions",watching:"All Activity",ignoring:"Ignore",custom:"Custom"},x={...y,none:"Participating"},g={none:"Watch",watching:"Unwatch",ignoring:"Stop ignoring",custom:"Unwatch"},f=[{name:y.none,description:"Only receive notifications from this repository when participating or @mentioned.",subscriptionType:"none"},{name:y.watching,description:"Notified of all notifications on this repository.",subscriptionType:"watching"},{name:y.ignoring,description:"Never be notified.",subscriptionType:"ignoring"},{name:y.custom,description:"Select events you want to be notified of in addition to participating and @mentions.",trailingIcon:(0,o.createElement)(u.ArrowRightIcon),subscriptionType:"custom"}],C=e=>e in g?g[e]:"",v=(e,t)=>{let s=C(e),a=x[e];return"ignoring"===e?`${s} in ${t}`:`${s}: ${a} in ${t}`};function j(e){return(0,r.jsx)(p.l,{selectionVariant:"single",children:f.map((t,s)=>(0,r.jsxs)(o.Fragment,{children:[(0,r.jsxs)(p.l.Item,{selected:t.subscriptionType===e.selected,onSelect:()=>e.onSelect(t.subscriptionType),children:[(0,r.jsx)(b.A,{sx:{fontWeight:"bold"},children:t.name}),(0,r.jsx)(p.l.Description,{variant:"block",children:t.description}),t.trailingIcon?(0,r.jsx)(p.l.TrailingVisual,{children:t.trailingIcon}):null]}),s!==f.length-1?(0,r.jsx)(p.l.Divider,{}):""]},s))})}try{j.displayName||(j.displayName="SubscriptionList")}catch{}var T=s(82560),N=s(65607),S=s(67269),_=s(55847),w=s(94977),I=s(30595);let k={footerContainer:"FooterActions-module__footerContainer--Z9ixI",buttonsContainer:"FooterActions-module__buttonsContainer--lkkwg"};function A(e){let[t,s]=(0,o.useState)(!1),a=(0,o.useCallback)(()=>(e.nextFocusRef?.current?.focus(),!0),[e.nextFocusRef]),n=(0,o.useCallback)(()=>{s(!0)},[]),i=(0,o.useCallback)(()=>{e.onApply(),setTimeout(()=>{e?.checkStatus&&e.checkStatus(n)},600)},[e,n]);return(0,r.jsxs)("div",{className:k.footerContainer,children:[e.showError?(0,r.jsx)(b.A,{sx:{py:3,pl:3,color:"var(--fgColor-muted, var(--color-fg-muted))"},children:"Error. Please try again."}):null,(0,r.jsxs)("div",{className:k.buttonsContainer,style:e.overrideButtonStyles??{padding:"var(--base-size-16)"},children:[!e.showError&&t?(0,r.jsx)(I.A,{size:"small",sx:{mr:2}}):null,(0,r.jsx)(_.Q,{size:"small",onClick:()=>e.onCancel(),onBlur:t=>{e.disabled&&a(t)},children:"Cancel"}),(0,r.jsx)(_.Q,{disabled:e.disabled,variant:"primary",size:"small",onClick:()=>i(),onBlur:a,sx:{ml:2},children:"Apply"})]})]})}try{A.displayName||(A.displayName="FooterActions")}catch{}function L(e){let[t,s]=(0,o.useState)(!1),[a,n]=(0,o.useState)(""),i=e.items.filter(e=>e?.text?.toLowerCase().startsWith(a.toLowerCase())),l=(0,o.useCallback)(()=>{e.applyLabels(),s(!1)},[e]),c=(0,o.useCallback)(()=>{e.resetLabels(),s(!1)},[e]),d=o.memo(R);return(0,r.jsx)(S.X,{title:"Select labels",renderAnchor:t=>0===e.items.length?(0,r.jsx)(w.A,{text:"Add labels to this repository to filter on them.",direction:"s",children:(0,r.jsx)(d,{anchorProps:t,itemsLength:e.items.length,labelsText:e.labelsText})}):(0,r.jsx)(d,{anchorProps:t,itemsLength:e.items.length,labelsText:e.labelsText}),placeholderText:"Filter labels",open:t,onOpenChange:s,items:i,selected:e.selectedLabels,onSelectedChange:e.onChangeLabels,onFilterChange:n,showItemDividers:!0,overlayProps:{width:"small",height:"medium",maxHeight:"medium"},footer:(0,r.jsx)("div",{style:{width:"100%"},children:(0,r.jsx)(A,{onCancel:c,onApply:l,overrideButtonStyles:{padding:"var(--base-size-8)"}})})})}let R=({anchorProps:e,itemsLength:t,labelsText:s})=>(0,r.jsx)(_.Q,{leadingVisual:u.TagIcon,trailingAction:u.TriangleDownIcon,...e,"aria-label":"Filter labels","aria-describedby":"select-labels","aria-haspopup":"dialog",size:"small",disabled:0===t,children:0===t?"No labels available":(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"color-fg-muted",children:"Labels: "}),(0,r.jsx)("span",{id:"select-labels",children:s})]})});try{L.displayName||(L.displayName="FilterLabels")}catch{}try{(i=ButtonFilter).displayName||(i.displayName="ButtonFilter")}catch{}let F=e=>{let t=P(e,2);if(e.length>=2){if(2===e.length)return O(e);let s=P(e,3);if(s.length>30)return`${t.slice(0,30)}... +${e.length-2} more`;{let t=e.length>3?` +${e.length-3} more`:"";return`${s}${t}`}}if(1!==e.length)return"All";{let t=e[0]?.text||"";return t.length>30?`${t.slice(0,30)}...`:t}},O=e=>{let t=e[0]?.text||"",s=P(e,2);return s.length>30?t.length>25?`${t.slice(0,25)}... +1 more`:`${s.slice(0,30)}...`:s},P=(e,t)=>e.slice(0,t).map(e=>e.text).join(", "),E=e=>{switch(e){case"PullRequest":return"Pull requests";case"SecurityAlert":return"Security alerts";default:return`${e}s`}},M={filterContainer:"ThreadList-module__filterContainer--eNebD",threadContent:"ThreadList-module__threadContent--Ry8II",threadRow:"ThreadList-module__threadRow--lx6FW"};function $(e){let[t,s]=(0,o.useState)(e.appliedThreads),[a,n]=(0,o.useState)(e.appliedLabels),[i,l]=(0,o.useState)(e.appliedLabels),[c,d]=(0,o.useState)(()=>F(e.appliedLabels));(0,o.useEffect)(()=>{e.appliedLabels.length>0&&!t.includes("Issue")&&s([...t,"Issue"])},[]);let u=(0,o.useCallback)(e=>{t&&t.includes(e)?s(t.filter(t=>t!==e)):s([...t,e])},[t]),h=(0,o.useCallback)(()=>{e.applyThreads(t)},[e,t]),m=(0,o.useCallback)(e=>{l(e),d(F(e))},[]),p=(0,o.useCallback)(()=>{n(i)},[i]),y=(0,o.useCallback)(()=>{l(a),d(F(a))},[a]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:M.threadContent,children:e.subscribableThreadTypes.map((s,a)=>(0,r.jsxs)("div",{className:M.threadRow,style:a===e.subscribableThreadTypes.length-1?{}:{borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))"},children:[(0,r.jsxs)(T.A,{children:[(0,r.jsx)(N.A,{checked:t.includes(s.name),onChange:()=>u(s.name)}),(0,r.jsx)(T.A.Label,{children:E(s.name)})]}),s.enabled?null:(0,r.jsxs)(b.A,{as:"p",sx:{fontSize:"12px",m:0,color:"var(--fgColor-muted)",ml:"var(--base-size-24)"},children:[E(s.name)," are not enabled for this repository"]}),(0,r.jsx)("div",{"aria-live":"polite",children:"Issue"===s.name&&e.showLabelSubscriptions&&t.includes("Issue")?(0,r.jsx)("div",{className:M.filterContainer,children:(0,r.jsx)(L,{filterAction:h,items:e.repoLabels,labelsText:c,onChangeLabels:m,selectedLabels:i,applyLabels:p,resetLabels:y})}):null})]},a))}),(0,r.jsx)(A,{onCancel:e.cancelMenuCallback,onApply:()=>e.saveThreads(t,i),showError:e.showError,disabled:0===t.length||e.isSavingThreads})]})}try{$.displayName||($.displayName="ThreadList")}catch{}let B={watchCounter:"NotificationsSubscriptionsMenu-module__watchCounter--nAbhU",watchButton:"NotificationsSubscriptionsMenu-module__watchButton--ifxlS"};function G({repositoryId:e,repositoryName:t,watchersCount:s,subscriptionType:a,subscribableThreadTypes:i,repositoryLabels:l,showLabelSubscriptions:h}){let p=(0,o.useMemo)(()=>l.map(e=>({id:e.id,text:e.name,selected:e.subscribed})),[l]),b=p.filter(e=>e.selected),y=(0,o.useMemo)(()=>i.map(e=>e.subscribed||"Issue"===e.name&&h&&b.length>0?e.name:null).filter(e=>null!==e),[i,h,b]),[x,g]=(0,o.useState)(!1),[f,T]=(0,o.useState)(!1),[N,S]=(0,o.useState)(y.length>0?n.CUSTOM:a),[_,w]=(0,o.useState)(N),[I,k]=(0,o.useState)(y),[A,L]=(0,o.useState)(b),[R,F]=(0,o.useState)(!1),O=(0,o.useRef)(null),P=(0,o.useCallback)(()=>{T(!1),S(_)},[_]),E=(0,o.useCallback)(async(t,s)=>{F(!0),k(t),L(s),w(n.CUSTOM);let a=new FormData;a.set("do","custom"),a.set("repository_id",e),t.map(e=>{a.append("thread_types[]",e)}),s.map(e=>{e.id&&a.append("labels[]",e.id.toString())}),(await m(a)).ok?(T(!1),F(!1)):g(!0)},[e]),M=(0,o.useCallback)(async t=>{let s=new FormData;t===n.IGNORING?s.set("do","ignore"):t===n.WATCHING?s.set("do","subscribed"):(t===n.NONE||t===n.CUSTOM&&0===I.length)&&s.set("do","included"),s.append("thread_types[]",""),s.set("repository_id",e),await m(s)},[e,I]),G=(0,o.useCallback)(e=>{e===n.CUSTOM?(T(!0),S(n.CUSTOM)):(S(e),w(e),M(e),k([]))},[S]),W=(0,o.useCallback)(e=>{k(e)},[k]),D=(0,o.useMemo)(()=>v(N,t),[N,t]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"d-md-none",children:(0,r.jsxs)(c.W,{children:[(0,r.jsx)(c.W.Button,{"data-testid":"notifications-subscriptions-menu-button-desktop",leadingVisual:N===n.IGNORING?u.BellSlashIcon:u.EyeIcon,trailingAction:null,className:B.watchButton,"aria-label":D,children:(0,r.jsx)(r.Fragment,{})}),(0,r.jsx)(c.W.Overlay,{width:"medium",children:(0,r.jsx)(j,{selected:N,onSelect:G})})]})}),(0,r.jsx)("div",{className:"d-none d-md-block",children:(0,r.jsxs)(c.W,{children:[(0,r.jsxs)(c.W.Button,{"data-testid":"notifications-subscriptions-menu-button-mobile",size:"small",leadingVisual:N===n.IGNORING?u.BellSlashIcon:u.EyeIcon,sx:{'&& [data-component="leadingVisual"]':{color:"var(--fgColor-muted, var(--color-fg-muted))"}},"aria-label":D,children:[C(N),(0,r.jsx)("span",{className:`ml-2 Counter rounded-3 ${B.watchCounter}`,children:s})]}),(0,r.jsx)(c.W.Overlay,{width:"medium",children:(0,r.jsx)(j,{selected:N,onSelect:G})})]})}),(0,r.jsx)(d.A,{returnFocusRef:O,isOpen:f,onDismiss:()=>P(),"aria-labelledby":"header",children:(0,r.jsxs)("div",{"data-testid":"inner",children:[(0,r.jsxs)(d.A.Header,{id:"header",children:["Subscribe to events for ",t]}),(0,r.jsx)($,{subscribableThreadTypes:i,showLabelSubscriptions:h,cancelMenuCallback:P,appliedThreads:I,repoLabels:p,subscribedThreads:y,applyThreads:W,appliedLabels:A,saveThreads:E,showError:x,isSavingThreads:R})]})})]})}try{G.displayName||(G.displayName="NotificationsSubscriptionsMenu")}catch{}(0,l.k)("notifications-subscriptions-menu",{Component:G})},24620:(e,t,s)=>{s.d(t,{Y:()=>a});function a(){let e={};return e.promise=new Promise((t,s)=>{e.resolve=t,e.reject=s}),e}},23581:(e,t,s)=>{s.d(t,{A:()=>r});let{getItem:a,setItem:n,removeItem:i}=(0,s(74572).A)("localStorage"),l="REACT_PROFILING_ENABLED",r={enable:()=>n(l,"true"),disable:()=>i(l),isEnabled:()=>!!a(l)}},59840:(e,t,s)=>{s.d(t,{m:()=>i});var a=s(96540),n=s(97156);function i(e,t){n.KJ&&(0,a.useLayoutEffect)(e,t)}},73272:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(59840),n=s(96540);function i(){let e=(0,n.useRef)(!1),t=(0,n.useCallback)(()=>e.current,[]);return(0,a.m)(()=>(e.current=!0,()=>{e.current=!1}),[]),t}},83784:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(73272),n=s(96540);let i=function(e){let t=(0,a.A)(),[s,i]=(0,n.useState)(e);return[s,(0,n.useCallback)(e=>{t()&&i(e)},[t])]}},28784:(e,t,s)=>{function a(e,t={}){!function(e){if(new URL(e,window.location.origin).origin!==window.location.origin)throw Error("Can not make cross-origin requests from verifiedFetch")}(e);let s={...t.headers,"GitHub-Verified-Fetch":"true","X-Requested-With":"XMLHttpRequest"};return fetch(e,{...t,headers:s})}function n(e,t){let s={...t?.headers??{},Accept:"application/json","Content-Type":"application/json"},n=t?.body?JSON.stringify(t.body):void 0;return a(e,{...t,body:n,headers:s})}function i(e,t={}){let s={...t.headers,"GitHub-Is-React":"true"};return a(e,{...t,headers:s})}function l(e,t){let s={...t?.headers??{},"GitHub-Is-React":"true"};return n(e,{...t,headers:s})}s.d(t,{DI:()=>a,QJ:()=>i,Sr:()=>l,lS:()=>n})},37190:(e,t,s)=>{s.d(t,{y:()=>l});var a=s(74848),n=s(96540),i=s(31481);function l({children:e,appName:t,category:s,metadata:l}){let r=(0,n.useMemo)(()=>({appName:t,category:s,metadata:l}),[t,s,l]);return(0,a.jsx)(i.I.Provider,{value:r,children:e})}try{l.displayName||(l.displayName="AnalyticsProvider")}catch{}},47831:(e,t,s)=>{s.d(t,{BP:()=>d,D3:()=>c,O8:()=>a});var a,n=s(74848),i=s(96540),l=s(97156),r=s(59840);!function(e){e.ServerRender="ServerRender",e.ClientHydrate="ClientHydrate",e.ClientRender="ClientRender"}(a||(a={}));let o=(0,i.createContext)("ClientRender");function c({wasServerRendered:e,children:t}){let[s,a]=(0,i.useState)(()=>l.X3?"ServerRender":e?"ClientHydrate":"ClientRender");return(0,r.m)(()=>{"ClientRender"!==s&&a("ClientRender")},[s]),(0,n.jsx)(o.Provider,{value:s,children:t})}function d(){return(0,i.useContext)(o)}try{o.displayName||(o.displayName="RenderPhaseContext")}catch{}try{c.displayName||(c.displayName="RenderPhaseProvider")}catch{}},54156:(e,t,s)=>{s.d(t,{Qn:()=>o,T8:()=>d,Y6:()=>h,k6:()=>u});var a=s(74848),n=s(65556),i=s(96540),l=s(67726),r=s(83784);let o=5e3,c=(0,i.createContext)({addToast:l.l,addPersistedToast:l.l,clearPersistedToast:l.l}),d=(0,i.createContext)({toasts:[],persistedToast:null});function u({children:e}){let[t,s]=(0,r.A)([]),[l,u]=(0,i.useState)(null),{safeSetTimeout:h}=(0,n.A)(),m=(0,i.useCallback)(function(e){s([...t,e]),h(()=>s(t.slice(1)),o)},[t,h,s]),p=(0,i.useCallback)(function(e){u(e)},[u]),b=(0,i.useCallback)(function(){u(null)},[u]),y=(0,i.useMemo)(()=>({addToast:m,addPersistedToast:p,clearPersistedToast:b}),[p,m,b]),x=(0,i.useMemo)(()=>({toasts:t,persistedToast:l}),[t,l]);return(0,a.jsx)(c.Provider,{value:y,children:(0,a.jsx)(d.Provider,{value:x,children:e})})}function h(){return(0,i.useContext)(c)}try{c.displayName||(c.displayName="ToastContext")}catch{}try{d.displayName||(d.displayName="InternalToastsContext")}catch{}try{u.displayName||(u.displayName="ToastContextProvider")}catch{}},67870:(e,t,s)=>{s.d(t,{V:()=>h});var a=s(74848),n=s(96540),i=s(54156),l=s(38621),r=s(65556),o=s(16255);let c={info:"",success:"Toast--success",error:"Toast--error"},d={info:(0,a.jsx)(l.InfoIcon,{}),success:(0,a.jsx)(l.CheckIcon,{}),error:(0,a.jsx)(l.StopIcon,{})},u=({message:e,timeToLive:t,icon:s,type:i="info",role:l="log"})=>{let[u,h]=n.useState(!0),{safeSetTimeout:m}=(0,r.A)();return(0,n.useEffect)(()=>{t&&m(()=>h(!1),t-300)},[m,t]),(0,a.jsx)(o.Z,{children:(0,a.jsx)("div",{className:"p-1 position-fixed bottom-0 left-0 mb-3 ml-3",children:(0,a.jsxs)("div",{className:`Toast ${c[i]} ${u?"Toast--animateIn":"Toast--animateOut"}`,id:"ui-app-toast","data-testid":`ui-app-toast-${i}`,role:l,children:[(0,a.jsx)("span",{className:"Toast-icon",children:s||d[i]}),(0,a.jsx)("span",{className:"Toast-content",children:e})]})})})};try{u.displayName||(u.displayName="Toast")}catch{}function h(){let{toasts:e,persistedToast:t}=(0,n.useContext)(i.T8);return(0,a.jsxs)(a.Fragment,{children:[e.map((e,t)=>(0,a.jsx)(u,{message:e.message,icon:e.icon,timeToLive:i.Qn,type:e.type,role:e.role},t)),t&&(0,a.jsx)(u,{message:t.message,icon:t.icon,type:t.type,role:t.role})]})}try{h.displayName||(h.displayName="Toasts")}catch{}}},e=>{var t=t=>e(e.s=t);e.O(0,["primer-react","react-core","react-lib","octicons-react","vendors-node_modules_primer_behaviors_dist_esm_index_mjs","vendors-node_modules_emotion_is-prop-valid_dist_emotion-is-prop-valid_esm_js-node_modules_emo-62da9f","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_stacktrace-parser_dist_s-e7dcdd","vendors-node_modules_oddbird_popover-polyfill_dist_popover-fn_js","ui_packages_failbot_failbot_ts"],()=>t(60882)),e.O()}]);
//# sourceMappingURL=notifications-subscriptions-menu-a04712c32fe4.js.map